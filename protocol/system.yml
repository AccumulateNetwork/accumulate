# Accounts and Transactions used internally by the protocol (not available to
# the user)

##### Accounts #####

SystemLedger:
  union: { type: account }
  fields:
    - name: Url
      type: url
      pointer: true
    - name: Index
      type: uint
    - name: Timestamp
      type: time
    - name: AcmeBurnt
      type: bigint
    - name: PendingUpdates
      type: NetworkAccountUpdate
      marshal-as: reference
      repeatable: true

SyntheticLedger:
  union: { type: account }
  fields:
    - name: Url
      type: url
      pointer: true
    - name: Subnets
      type: SubnetSyntheticLedger
      marshal-as: reference
      pointer: true
      repeatable: true

AnchorLedger:
  union: { type: account }
  fields:
    - name: Url
      type: url
      pointer: true
    - name: MajorBlockIndex
      description: is the block index of the last major block
      type: uint
    - name: MajorBlockTime
      description: is the timestamp of the last major block
      type: time
    - name: PendingMajorBlockAnchors
      description: is the list of partitions that have joined the open major block. If there is no open major block, this is unset
      type: url
      pointer: true
      repeatable: true

##### Transactions #####

SystemGenesis:
  union: { type: transaction }

PartitionAnchor:
  union: { type: transaction }
  embeddings:
    - SubnetAnchor
  fields:
    - name: AcmeBurnt
      description: is the amount of acme tokens burnt in the transaction
      type: bigint

DirectoryAnchor:
  union: { type: transaction }
  embeddings:
    - SubnetAnchor
  fields:
    - name: Updates
      description: are synchronization updates for network accounts
      type: NetworkAccountUpdate
      marshal-as: reference
      repeatable: true
    - name: Receipts
      description: are receipts for anchors from other subnets that were included in the block
      type: Receipt
      repeatable: true
      marshal-as: reference
    - name: MakeMajorBlock
      description: notifies the subnet that the DN has opened a major block
      type: uint

SystemWriteData:
  union: { type: transaction }
  fields:
    - name: Entry
      type: DataEntry
      marshal-as: union
    - name: WriteToState
      description: writes the data entry to the account state
      type: bool
      optional: true


##### Data Types #####

NetworkAccountUpdate:
  fields:
    - name: Name
      type: string
    - name: Body
      type: TransactionBody
      marshal-as: union

SubnetAnchor:
  fields:
    - name: Source
      description: is the principal of the transaction that produced this transaction
      type: url
      pointer: true
    - name: MajorBlockIndex
      description: is the major block index, or zero
      type: uint
    - name: MinorBlockIndex
      description: is the minor block index
      type: uvarint
    - name: RootChainIndex
      description: is the index of the last root chain entry
      type: uvarint
    - name: RootChainAnchor
      description: is the anchor of the root chain
      type: hash
    - name: StateTreeAnchor
      description: is the root of the source's state tree (BPT)
      type: hash

SubnetSyntheticLedger:
  fields:
    - name: Url
      description: is the URL of the subnet
      type: url
      pointer: true
    - name: Produced
      description: is the maximum sequence number of synthetic transactions produced for the subnet
      type: uint
    - name: Received
      description: is the maximum sequence number of synthetic transactions received from the subnet
      type: uint
    - name: Delivered
      description: is the maximum sequence number of delivered synthetic transactions received from the subnet
      type: uint
    - name: Pending
      description: is the transaction hashes of synthetic transactions received out of order
      type: txid
      pointer: true
      repeatable: true