RequestKeyPageIndex:
  fields:
    - name: Url
      type: url
      pointer: true
    - name: Key
      type: bytes

ResponseKeyPageIndex:
  fields:
    - name: KeyBook
      type: url
      pointer: true
    - name: KeyPage
      type: url
      pointer: true
    - name: Index
      type: uvarint
      keep-empty: true

ResponseTxHistory:
  fields:
    - name: Start
      type: uint
      keep-empty: true
    - name: End
      type: uint
      keep-empty: true
    - name: Total
      type: uint
      keep-empty: true
    - name: Transactions
      repeatable: true
      type: ResponseByTxId
      marshal-as: reference

ResponseChainRange:
  fields:
    - name: Start
      type: varint
      keep-empty: true
    - name: End
      type: varint
      keep-empty: true
    - name: Total
      type: varint
      keep-empty: true
    - name: Entries
      repeatable: true
      type: bytes

ResponseChainEntry:
  fields:
    - name: Height
      type: varint
      keep-empty: true
    - name: Entry
      type: bytes
    - name: State
      repeatable: true
      type: bytes

ResponseByTxId:
  fields:
    - name: TxId
      type: chain
    - name: Envelope
      type: protocol.Envelope
      marshal-as: reference
      pointer: true
    - name: Status
      type: protocol.TransactionStatus
      marshal-as: reference
      pointer: true
    - name: TxSynthTxIds
      type: bytes
    - name: Height
      type: varint
      keep-empty: true
    - name: ChainState
      repeatable: true
      type: bytes
    - name: Receipts
      repeatable: true
      type: TxReceipt
      marshal-as: reference
      pointer: true
    - name: SignatureThreshold
      type: uvarint
    - name: Invalidated
      type: bool

TxReceipt:
  fields:
    - name: Account
      type: url
      marshal-as: reference
      pointer: true
    - name: Chain
      type: string
    # - name: DirectoryBlock
    #   type: uvarint
    - name: Receipt
      type: protocol.Receipt
      marshal-as: reference
    - name: Error
      type: string

ResponsePending:
  fields:
    - name: Transactions
      type: chain
      repeatable: true

MultiResponse:
  incomparable: true
  fields:
    - name: Type
      type: string
    - name: Items
      repeatable: true
      type: string
    - name: Start
      type: uvarint
      keep-empty: true
    - name: Count
      type: uvarint
      keep-empty: true
    - name: Total
      type: uvarint
      keep-empty: true

RequestTxHistory:
  fields:
    - name: Account
      type: url
      pointer: true
    - name: Start
      type: uint
    - name: Limit
      type: uint

DirectoryQueryResult:
  fields:
    - name: Entries
      repeatable: true
      type: string
      optional: true
    - name: ExpandedEntries
      repeatable: true
      type: protocol.Account
      marshal-as: value
      unmarshal-with: protocol.UnmarshalAccount
      optional: true
    - name: Total
      type: uvarint
      keep-empty: true

RequestDataEntry:
  fields:
    - name: Url
      type: url
      pointer: true
    - name: EntryHash
      type: chain
      optional: true

RequestDataEntrySet:
  fields:
    - name: Url
      type: url
      pointer: true
    - name: Start
      type: uvarint
    - name: Count
      type: uvarint
    - name: ExpandChains
      type: bool
      optional: true

ResponseDataEntry:
  fields:
    - name: EntryHash
      type: chain
    - name: Entry
      type: protocol.DataEntry
      marshal-as: reference

ResponseDataEntrySet:
  fields:
    - name: DataEntries
      repeatable: true
      type: ResponseDataEntry
      marshal-as: reference
    - name: Total
      type: uvarint

ChainState:
  fields:
    - name: Name
      type: string
    - name: Type
      type: protocol.ChainType
      marshal-as: enum
    - name: Height
      type: uvarint
      alternative: Count
    - name: Roots
      repeatable: true
      type: bytes

ResponseAccount:
  fields:
    - name: Account
      type: protocol.Account
      marshal-as: value
      unmarshal-with: protocol.UnmarshalAccount
      zero-value: nil
    - name: ChainState
      type: ChainState
      marshal-as: reference
      repeatable: true

RequestMinorBlocks:
  fields:
    - name: Account
      type: url
      pointer: true
    - name: Start
      type: uint
    - name: Limit
      type: uint

ResponseMinorBlocks:
  fields:
    - name: Start
      type: uint
      keep-empty: true
    - name: End
      type: uint
      keep-empty: true
    - name: Total
      type: uint
      keep-empty: true
    - name: Entries
      repeatable: true
      type: ResponseMinorEntry
      pointer: true
      marshal-as: reference

ResponseMinorEntry:
  embeddings:
    - ResponseByTxId
  fields:
    - name: BlockIndex
      description: is the index of the block. Only include when indexing the root anchor chain
      type: uint
    - name: BlockTime
      description: is the start time of the block.
      type: time
      pointer: true
