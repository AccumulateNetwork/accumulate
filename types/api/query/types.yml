RequestKeyPageIndex:
  fields:
    - name: Url
      type: url
      pointer: true
    - name: Key
      type: bytes

ResponseKeyPageIndex:
  fields:
    - name: Authority
      alternative: KeyBook
      type: url
      pointer: true
    - name: Signer
      alternative: KeyPage
      type: url
      pointer: true
    - name: Index
      type: uvarint
      keep-empty: true

ResponseTxHistory:
  fields:
    - name: Start
      type: uint
      keep-empty: true
    - name: End
      type: uint
      keep-empty: true
    - name: Total
      type: uint
      keep-empty: true
    - name: Transactions
      repeatable: true
      type: ResponseByTxId
      marshal-as: reference

ResponseChainRange:
  fields:
    - name: Type
      type: protocol.ChainType
      marshal-as: enum
    - name: Start
      type: varint
      keep-empty: true
    - name: End
      type: varint
      keep-empty: true
    - name: Total
      type: varint
      keep-empty: true
    - name: Entries
      repeatable: true
      type: bytes

ResponseChainEntry:
  fields:
    - name: Type
      type: protocol.ChainType
      marshal-as: enum
    - name: Height
      type: varint
      keep-empty: true
    - name: Entry
      type: bytes
    - name: State
      repeatable: true
      type: bytes
    - name: Receipt
      type: GeneralReceipt
      marshal-as: reference
      pointer: true
      optional: true

ResponseByTxId:
  fields:
    - name: TxId
      type: chain
    - name: Envelope
      type: protocol.Envelope
      marshal-as: reference
      pointer: true
    - name: Status
      type: protocol.TransactionStatus
      marshal-as: reference
      pointer: true
    - name: TxSynthTxIds
      type: bytes
    - name: Height
      type: varint
      keep-empty: true
    - name: ChainState
      repeatable: true
      type: bytes
    - name: Receipts
      repeatable: true
      type: TxReceipt
      marshal-as: reference
      pointer: true
    - name: Signers
      type: SignatureSet
      marshal-as: reference
      repeatable: true

SignatureSet:
  fields:
    - name: Account
      type: protocol.Account
      marshal-as: union
    - name: Signatures
      type: protocol.Signature
      marshal-as: union
      repeatable: true

GeneralReceipt:
  fields:
    - name: LocalBlock
      type: uvarint
    - name: DirectoryBlock
      type: uvarint
    - name: Receipt
      type: protocol.Receipt
      marshal-as: reference
    - name: Error
      type: string

TxReceipt:
  embeddings:
  - GeneralReceipt
  fields:
    - name: Account
      type: url
      marshal-as: reference
      pointer: true
    - name: Chain
      type: string

ResponsePending:
  fields:
    - name: Transactions
      type: chain
      repeatable: true

MultiResponse:
  incomparable: true
  fields:
    - name: Type
      type: string
    - name: Items
      repeatable: true
      type: string
    - name: Start
      type: uvarint
      keep-empty: true
    - name: Count
      type: uvarint
      keep-empty: true
    - name: Total
      type: uvarint
      keep-empty: true

RequestTxHistory:
  fields:
    - name: Account
      type: url
      pointer: true
    - name: Start
      type: uint
    - name: Limit
      type: uint

DirectoryQueryResult:
  fields:
    - name: Entries
      repeatable: true
      type: string
      optional: true
    - name: ExpandedEntries
      type: protocol.Account
      marshal-as: union
      optional: true
      repeatable: true
    - name: Total
      type: uvarint
      keep-empty: true

RequestDataEntry:
  fields:
    - name: Url
      type: url
      pointer: true
    - name: EntryHash
      type: chain
      optional: true

RequestDataEntrySet:
  fields:
    - name: Url
      type: url
      pointer: true
    - name: Start
      type: uvarint
    - name: Count
      type: uvarint
    - name: ExpandChains
      type: bool
      optional: true

ResponseDataEntry:
  fields:
    - name: EntryHash
      type: chain
    - name: Entry
      type: protocol.DataEntry
      marshal-as: union

ResponseDataEntrySet:
  fields:
    - name: DataEntries
      repeatable: true
      type: ResponseDataEntry
      marshal-as: reference
    - name: Total
      type: uvarint

ChainState:
  fields:
    - name: Name
      type: string
    - name: Type
      type: protocol.ChainType
      marshal-as: enum
    - name: Height
      type: uvarint
      alternative: Count
    - name: Roots
      repeatable: true
      type: bytes

ResponseAccount:
  fields:
    - name: Account
      type: protocol.Account
      marshal-as: union
    - name: ChainState
      type: ChainState
      marshal-as: reference
      repeatable: true
    - name: Receipt
      type: GeneralReceipt
      marshal-as: reference
      pointer: true
      optional: true

RequestMinorBlocks:
  fields:
    - name: Account
      type: url
      pointer: true
    - name: Start
      type: uint
    - name: Limit
      type: uint
    - name: TxFetchMode
      type: TxFetchMode
      marshal-as: enum
    - name: FilterSystemAnchorsOnlyBlocks
      type: bool

ResponseMinorBlocks:
  fields:
    - name: Start
      type: uint
      keep-empty: true
    - name: End
      type: uint
      keep-empty: true
    - name: Total
      type: uint
      keep-empty: true
    - name: Entries
      repeatable: true
      type: ResponseMinorEntry
      pointer: true
      marshal-as: reference

ResponseMinorEntry:
  fields:
    - name: BlockIndex
      description: is the index of the block. Only include when indexing the root anchor chain
      type: uint
    - name: BlockTime
      description: is the start time of the block.
      type: time
      pointer: true
    - name: TxCount
      description: shows how many transactions this block contains
      type: uint
    - name: TxIds
      repeatable: true
      type: bytes
    - name: Transactions
      description: the transactions within this block
      type: ResponseByTxId
      repeatable: true
      pointer: true
      marshal-as: reference
